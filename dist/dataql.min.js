/*! dataql v0.1 */
Array.from||(Array.from=function(){var a=["[object Map Iterator]","[object Set Iterator]","[object WeakMap Iterator]","[object WeakSet Iterator]"],b=Object.prototype.toString,c=function(a){return"function"==typeof a||"[object Function]"===b.call(a)},d=function(a){var b=Number(a);return isNaN(b)?0:0!==b&&isFinite(b)?(b>0?1:-1)*Math.floor(Math.abs(b)):b},e=Math.pow(2,53)-1,f=function(a){var b=d(a);return Math.min(Math.max(b,0),e)};return function(b){var d=function(a,b){return j[b]=i?"undefined"==typeof h?i(a,b):i.call(h,a,b):a,b+1},e=this,g=Object(b);if(null==b)throw new TypeError("Array.from requires an array-like object - not null or undefined");var h,i=arguments.length>1?arguments[1]:void 0;if("undefined"!=typeof i){if(!c(i))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(h=arguments[2])}var j=c(e)?Object(new e(m)):new Array(m),k=0;if(-1!==a.indexOf(g.toString())){for(var l;l=g.next().value;)k=d(l,k);return j.length=k,j}for(var m=f(g.length);m>k;)k=d(g[k],k);return j.length=m,j}}());var CKAN={},isNodeModule="undefined"!=typeof module&&null!=module&&"undefined"!=typeof require;if(isNodeModule){var _=require("underscore"),request=require("request");module.exports=CKAN}!function(a){a.Client=function(a,c){this.endpoint=b(a),this.apiKey=c},a.Client.prototype.action=function(a,b,c){a.indexOf(!1)&&(a=a.replace("dataset_","package_"));var d={url:this.endpoint+"/3/action/"+a,data:b,type:"POST"};return this._ajax(d,c)},a.Client.prototype._ajax=function(a,b){a.headers=a.headers||{},this.apiKey&&(a.headers["X-CKAN-API-KEY"]=this.apiKey);var e=isNodeModule?c:d;return e(a,b)},a.Client.prototype.datastoreQuery=function(b,c){var d=a._normalizeQuery(b);this.action("datastore_search",d,function(b,d){if(b)return void c(b);var e=_.map(d.result.fields,function(b){return b.type=b.type in a.ckan2JsonTableSchemaTypes?a.ckan2JsonTableSchemaTypes[b.type]:b.type,b}),f={total:d.result.total,fields:e,hits:d.result.records};c(null,f)})},a.Client.prototype.datastoreSqlQuery=function(b,c){this.action("datastore_search_sql",{sql:b},function(b,d){if(b){var e=JSON.parse(b.message),f={original:b,code:b.code,message:e.error.info.orig[0]};return void c(f)}var g=_.map(d.result.fields,function(b){return b.type=b.type in a.ckan2JsonTableSchemaTypes?a.ckan2JsonTableSchemaTypes[b.type]:b.type,b}),h={total:d.result.length,fields:g,hits:d.result.records};c(null,h)})},a.ckan2JsonTableSchemaTypes={text:"string","int":"integer",int4:"integer",int8:"integer",float8:"float",timestamp:"datetime",bool:"boolean"},a.jsonTableSchema2CkanTypes={string:"text",number:"float",integer:"int",datetime:"timestamp","boolean":"bool",binary:"bytea",object:"json",array:"text[]",any:"text"},a.Client.prototype.datastoreResources=function(a){var b={resource_id:"_table_metadata"};return this.action("datastore_search",b,a)};var b=function(a){return a=a||"/",a=a.replace(/\/$/,""),a.match(/\/api$/)||(a+="/api"),a},c=function(a,b){var c={url:a.url,headers:a.headers||{},method:a.type||"GET",json:a.data};request(c,function(a,c,d){!a&&c&&200!==c.statusCode&&302!==c.statusCode&&(a="CKANJS API Error. HTTP code "+c.statusCode+". Message: "+JSON.stringify(d,null,2)),b(a,d)})},d=function(a,b){return a.data=encodeURIComponent(JSON.stringify(a.data)),a.success=function(a){b(null,a)},a.error=function(a){var c={code:a.status,message:a.responseText};b(c)},a.headers&&(a.beforeSend=function(b){for(key in a.headers)b.setRequestHeader(key,a.headers[key])}),jQuery.ajax(a)};a._normalizeQuery=function(a){var b={resource_id:a.resource_id,q:a.q,filters:{},limit:a.size||10,offset:a.from||0};if(a.sort&&a.sort.length>0){var c=_.map(a.sort,function(a){return a.field+" "+(a.order||"")});b.sort=c.join(",")}return a.filters&&a.filters.length>0&&_.each(a.filters,function(a){"term"===a.type&&(b.filters[a.field]=a.term)}),b},a.parseCkanResourceUrl=function(a){parts=a.split("/");var b=parts.length;return{resource_id:parts[b-1],endpoint:parts.slice(0,[b-4]).join("/")+"/api"}}}(CKAN);var recline=recline||{};recline.Backend=recline.Backend||{},recline.Backend.Ckan=recline.Backend.Ckan||{},function(a){a.__type__="ckan";var b=_.isUndefined(this.jQuery)?_.Deferred:jQuery.Deferred;a.fetch=function(c){var d=new b;return a.query({},c).done(function(a){d.resolve({fields:a.fields,records:a.hits})}).fail(function(a){d.reject(a)}),d.promise()},a.query=function(a,c){var d,e=new b;if(c.endpoint)d=new CKAN.Client(c.endpoint);else{var f=CKAN.parseCkanResourceUrl(c.url);c.id=f.resource_id,d=new CKAN.Client(f.endpoint)}return a.resource_id=c.id,d.datastoreQuery(a,function(a,b){a?e.reject(a):e.resolve(b)}),e.promise()}}(recline.Backend.Ckan);var CSV={};!function(a){"use strict";function b(a){return"\n"!==a.charAt(a.length-1)?a:a.substring(0,a.length-1)}a.__type__="csv";var c="undefined"!=typeof jQuery&&jQuery.Deferred||_.Deferred;a.fetch=function(b){var d=new c;if(b.file){var e=new FileReader,f=b.encoding||"UTF-8";e.onload=function(c){var e=a.extractFields(a.parse(c.target.result,b),b);e.useMemoryStore=!0,e.metadata={filename:b.file.name},d.resolve(e)},e.onerror=function(a){alert("Failed to load file. Code: "+a.target.error.code)},e.readAsText(b.file,f)}else if(b.data){var g=a.extractFields(a.parse(b.data,b),b);g.useMemoryStore=!0,d.resolve(g)}else b.url&&jQuery.get(b.url).done(function(c){var e=a.extractFields(a.parse(c,b),b);e.useMemoryStore=!0,d.resolve(e)});return d.promise()},a.extractFields=function(a,b){return b.noHeaderRow!==!0&&a.length>0?{fields:a[0],records:a.slice(1)}:{records:a}},a.normalizeDialectOptions=function(a){var b={delimiter:",",doublequote:!0,lineterminator:"\n",quotechar:'"',skipinitialspace:!0,skipinitialrows:0};for(var c in a)"trim"===c?b.skipinitialspace=a.trim:b[c.toLowerCase()]=a[c];return b},a.parse=function(c,f){c=b(c);var h,i,j=a.normalizeDialectOptions(f),k="",l=!1,m=!1,n="",o=[],p=[];for(i=function(a){return m!==!0&&(""===a?a=null:j.skipinitialspace===!0&&(a=g(a)),d.test(a)?a=parseInt(a,10):e.test(a)&&(a=parseFloat(a,10))),a},h=0;h<c.length;h+=1)k=c.charAt(h),l!==!1||k!==j.delimiter&&"\n"!==k?k!==j.quotechar?n+=k:l?c.charAt(h+1)===j.quotechar?(n+=j.quotechar,h+=1):l=!1:(l=!0,m=!0):(n=i(n),o.push(n),"\n"===k&&(p.push(o),o=[]),n="",m=!1);return n=i(n),o.push(n),p.push(o),j.skipinitialrows&&(p=p.slice(j.skipinitialrows)),p},a.objectToArray=function(a){for(var b=[],c=[],d=0;d<a.fields.length;d++)c.push(a.fields[d].id);b.push(c);for(var d=0;d<a.records.length;d++){for(var e=[],f=a.records[d],g=0;g<c.length;g++)e.push(f[c[g]]);b.push(e)}return b},a.serialize=function(b,c){var d=null;d=b instanceof Array?b:a.objectToArray(b);var e,g,h,i=a.normalizeDialectOptions(c),j="",k="",l="",m="";for(h=function(a){return null===a?a="":"string"==typeof a&&f.test(a)?(i.doublequote&&(a=a.replace(/"/g,'""')),a=i.quotechar+a+i.quotechar):"number"==typeof a&&(a=a.toString(10)),a},e=0;e<d.length;e+=1)for(j=d[e],g=0;g<j.length;g+=1)k=h(j[g]),g===j.length-1?(l+=k,m+=l+"\n",l=""):l+=k+i.delimiter,k="";return m};var d=/^\d+$/,e=/^\d*\.\d+$|^\d+\.\d*$/,f=/^\s|\s$|,|"|\n/,g=function(){return String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")}}()}(CSV);var recline=recline||{};recline.Backend=recline.Backend||{},recline.Backend.CSV=CSV;var ES={};!function(a){_.isUndefined(this.jQuery)?_.Deferred:jQuery.Deferred;a.Table=function(a,c){var d=this;this.endpoint=a,this.options=_.extend({dataType:"json"},c),this.mapping=function(){var a=d.endpoint+"/_mapping",c=b({url:a,dataType:this.options.dataType});return c},this.get=function(a){var c=this.endpoint+"/"+a;return b({url:c,dataType:"json"})},this.upsert=function(a){var c=JSON.stringify(a);return url=this.endpoint,a.id&&(url+="/"+a.id),b({url:url,type:"POST",data:c,dataType:"json"})},this.update=function(a,c){var d=JSON.stringify({doc:a});return b({url:this.endpoint+"/"+c+"/_update",type:"POST",data:d,dataType:"json"})},this.remove=function(a){return url=this.endpoint,url+="/"+a,b({url:url,type:"DELETE",dataType:"json"})},this._normalizeQuery=function(a){var b,c=this,d=a&&a.toJSON?a.toJSON():_.extend({},a);b=d.q?{query_string:{query:d.q}}:d.ids?{ids:{values:d.ids}}:{match_all:{}};var e;return d.filters&&d.filters.length?(e={filtered:{filter:{and:[]}}},_.each(d.filters,function(a){e.filtered.filter.and.push(c._convertFilter(a))}),(d.q||d.ids)&&(e.filtered.query=b)):(e={constant_score:{query:{}}},e.constant_score.query=b),e},this._normalizeSort=function(a){var b=_.map(a,function(a){var b={},c=_.clone(a);return delete c.field,b[a.field]=c,b});return b},this._convertFilter=function(a){var b={};return b[a.type]={},"term"===a.type?b.term[a.field]=a.term:"terms"===a.type?(b.terms[a.field]=a.terms,"execution"in a&&(b.terms.execution=a.execution)):"geo_distance"===a.type?(b.geo_distance[a.field]=a.point,b.geo_distance.distance=a.distance,b.geo_distance.unit=a.unit):"range"===a.type?(b.range[a.field]={from:a.from,to:a.to},_.has(a,"include_lower")&&(b.range[a.field].include_lower=a.include_lower),_.has(a,"include_upper")&&(b.range[a.field].include_upper=a.include_upper)):"type"==a.type?b.type={value:a.value}:"exists"==a.type?b.exists={field:a.field}:"missing"==a.type&&(b.missing={field:a.field}),a.not&&(b={not:JSON.parse(JSON.stringify(b))}),b},this.query=function(a){var c=a&&a.toJSON?a.toJSON():_.extend({},a);c.query=this._normalizeQuery(a),delete c.q,delete c.filters,c.sort&&c.sort.length>0&&(c.sort=this._normalizeSort(c.sort)),c.ids&&(c.size=c.ids.length,delete c.ids);var d=({source:JSON.stringify(c)},this.endpoint+"/_search"),e=b({url:d,type:"POST",data:JSON.stringify(c)});return e}};var b=function(a,b){var c={};b&&(c={beforeSend:function(a){_.each(b,function(b,c){a.setRequestHeader(c,b)})}});var a=_.extend(c,a);return jQuery.ajax(a)}}(ES);var recline=recline||{};recline.Backend=recline.Backend||{},recline.Backend.ElasticSearch=recline.Backend.ElasticSearch||{},function(a){"use strict";a.__type__="elasticsearch";var b=_.isUndefined(jQuery)?_.Deferred:jQuery.Deferred;a.esOptions={},a.fetch=function(c){var d=new ES.Table(c.url,a.esOptions),e=new b;return d.mapping().done(function(a){if(!a)return void e.reject({message:"Elastic Search did not return a mapping"});var b=_.keys(a)[0],c=_.map(a[b].properties,function(a,b){return a.id=b,a});e.resolve({fields:c})}).fail(function(a){e.reject(a)}),e.promise()},a.save=function(c,d){var e=new ES.Table(d.url,a.esOptions);if(c.creates.length+c.updates.length+c.deletes.length>1){var f=new b;return msg="Saving more than one item at a time not yet supported",alert(msg),f.reject(msg),f.promise()}return c.creates.length>0?e.upsert(c.creates[0]):c.updates.length>0?e.upsert(c.updates[0]):c.deletes.length>0?e.remove(c.deletes[0].id):void 0},a.update=function(b,c,d){var e=new ES.Table(d.url,a.esOptions);return e.update(b,c)},a.query=function(c,d){var e=new b,f=new ES.Table(d.url,a.esOptions),g=f.query(c);return g.done(function(a){var b={total:a.hits.total};b.hits=_.map(a.hits.hits,function(a){return"id"in a._source||!a._id||(a._source.id=a._id),a._source}),a.facets&&(b.facets=a.facets),e.resolve(b)}).fail(function(a){var b={title:"Failed: "+a.status+" code",message:a.responseText};e.reject(b)}),e.promise()}}(recline.Backend.ElasticSearch);var recline=recline||{};if(recline.Backend=recline.Backend||{},recline.Backend.GDocs=recline.Backend.GDocs||{},"undefined"!=typeof module&&null!=module&&"undefined"!=typeof require){var _=require("underscore");module.exports=recline}!function(a){a.__type__="gdocs";var b="undefined"!=typeof jQuery&&jQuery.Deferred||_.Deferred;a.fetch=function(c){var d=new b,e=a.getGDocsApiUrls(c.url,c.worksheetIndex);return function(){var a=new b;return jQuery.getJSON(e.spreadsheetAPI,function(b){a.resolve({spreadsheetTitle:b.feed.title.$t})}).fail(function(b){a.reject(b)}),a.promise()}().then(function(b){jQuery.getJSON(e.worksheetAPI,function(c){var f=a.parseData(c),g=_.map(f.fields,function(a){return{id:a}}),h=_.extend(e,{title:b.spreadsheetTitle+" - "+f.worksheetTitle,spreadsheetTitle:b.spreadsheetTitle,worksheetTitle:f.worksheetTitle});d.resolve({metadata:h,records:f.records,fields:g,useMemoryStore:!0})})}).fail(function(a){d.reject(a)}),d.promise()},a.parseData=function(a,b){var c,d,b=b||{},e=b.colTypes||{},f={fields:[],records:[]},g=a.feed.entry||[],h=/^([\d\.\-]+)\%$/;for(c in g[0])/^gsx/.test(c)&&(d=c.substr(4),f.fields.push(d));return f.records=_.map(g,function(a){var b=new Map;return _.each(f.fields,function(c){var d,f="gsx$"+c,g=a[f].$t;"percent"===e[c]&&h.test(g)&&(d=h.exec(g)[1],g=parseFloat(d)/100),b[c]=g}),b}),f.worksheetTitle=a.feed.title.$t,f},a.getGDocsApiUrls=function(a,b){var c=/.*spreadsheet\/ccc\?.*key=([^#?&+]+)[^#]*(#gid=([\d]+).*)?/,d=/.*spreadsheets\/d\/([^\/]+)\/edit(#gid=([\d]+).*)?/;return matches=a.match(c),matches2=a.match(d),matches?(key=matches[1],worksheet=parseInt(matches[3])+1,isNaN(worksheet)&&(worksheet=1)):matches2?(key=matches2[1],worksheet=1,isNaN(worksheet)&&(worksheet=1)):-1!=a.indexOf("spreadsheets.google.com/feeds")?(key=a.split("/")[5],worksheet=1):(key=a,worksheet=1),worksheet=b||0===b?b:worksheet,{worksheetAPI:"https://spreadsheets.google.com/feeds/list/"+key+"/"+worksheet+"/public/values?alt=json",spreadsheetAPI:"https://spreadsheets.google.com/feeds/worksheets/"+key+"/public/basic?alt=json",spreadsheetKey:key,worksheetIndex:worksheet}}}(recline.Backend.GDocs);var Inline={};!function(a){"use strict";a.__type__="inline";var b="undefined"!=typeof jQuery&&jQuery.Deferred||_.Deferred;a.fetch=function(a){var c=new b;return _.defer(c.resolve,a),c.promise()}}(Inline);var recline=recline||{};recline.Backend=recline.Backend||{},recline.Backend.Inline=Inline;var PapaCSV={};!function(a){"use strict";a.__type__="papacsv";var b="undefined"!=typeof jQuery&&jQuery.Deferred||_.Deferred;a.fetch=function(c){var d=new b,e={complete:_.partial(a._complete,_,d,c)};return c.file?Papa.parse(c.file,e):c.data?Papa.parse(c.data,e):c.url&&(e.download=!0,Papa.parse(c.url,e)),d.promise()},a._complete=function(b,c,d){var e=a.extractFields(b.data,d);e.useMemoryStore=!0,c.resolve(e)},a.extractFields=function(a,b){return b.noHeaderRow!==!0&&a.length>0?{fields:a[0],records:a.slice(1)}:{records:a}}}(PapaCSV);var recline=recline||{};recline.Backend=recline.Backend||{},recline.Backend.PapaCSV=PapaCSV,function(a){"use strict";function b(){var a=this;a._tables=[],a._operations=[],a._result=[]}b.operators={},b.operators["="]=function(a,b){return a==b},b.operators[">"]=function(a,b){return a>b},b.operators["<"]=function(a,b){return b>a},b.operators[">="]=function(a,b){return a>=b},b.operators["<="]=function(a,b){return b>=a},b.prototype._normalizeTable=function(a){return _.first(a.records)instanceof Map?a:(a.records=_.map(a.records,function(b){return _.object(a.fields,b)}),a)},b.prototype._getCmp=function(a){if(!_.isFunction(b.operators[a]))throw new Error("Operator not supported");return b.operators[a]},b.prototype._join=function(a,b,c){var d=this,e=[],f=d._getCmp(c.where.cmp);return _.has(a,c.table)&&(e=a[c.table].records),_.map(b,function(a){var b=_.filter(e,function(b){return f(a[c.where.left],b[c.where.right])});return _.extend(a,_.first(b))})},b.prototype._set=function(a,b,c){if(!_.has(a,c.table))throw new Error("Table not fetched. Fetch and name the table before set.");return a[c.table].records},b.prototype._filter=function(a,b,c){var d=this,e=d._getCmp(c.where.cmp);return _.filter(b,function(a){return e(a[c.where.left],c.where.right)})},b.prototype._limit=function(a,b,c){return b.slice(c.start,c.start+c.numRows)},b.prototype._sort=function(a,b,c){var d="desc"===c.order?!1:!0,e=c.field;return _.sortByOrder(b,e,d)},b.prototype._rename=function(a,b,c){return _.map(b,function(a){return a[c.newName]=a[c.oldName],_.omit(a,c.oldName)})},b.prototype._delete=function(a,b,c){return _.map(b,function(a){return _.omit(a,c.field)})},b.prototype._add=function(a,b,c){var d=this,e="column"===c.type?"addColumn":"addRow";return d["_"+e](a,b,c)},b.prototype._addColumn=function(a,b,c){var d=this,e=d._range(a,b,c.from);return _.map(b,function(a,b){return a[c.field]=e[b],a})},b.prototype._addRow=function(a,b,c){var d=this,e=d._range(a,b,c.from),f=_.first(b).keys();return b.push(d.toMap(Array.from(f),e)),b},b.prototype._groupBy=function(a,b,c){var d=_.values(_.groupBy(b,c.field));return _.map(d,function(a){return a[0]})},b.prototype._range=function(a,b,c){var d=this,e="column"===c.type?"vectorFromColumns":"vectorFromRows";return d["_"+e](a,c)},b.prototype._vectorFromColumns=function(a,b){var c=a[b.table].records[b.row],d=[],e=0;return c.forEach(function(a){(e>=b.from||e<=b.to)&&d.push(a),++e}),d},b.prototype._vectorFromRows=function(a,b){var c=a[b.table].records;return _.reduce(c,function(a,c,d){return d>=b.from&&d<=b.to&&a.push(c[b.field]),a},[])},b.prototype._runOps=function(){var a=this;return _.each(a._operations,function(b){a._result=a["_"+b.method](a._resources,a._result,_.omit(b,"method"))}),a},b.prototype._backendFromString=function(a){return _.findWhere(recline.Backend,{__type__:a})},b.prototype._fetchResources=function(){var a=this,b=[];return _.each(a._tables,function(c){var d=a._backendFromString(c.backend);if(!d)throw new Error("Backend not found");b.push(d.fetch(c))}),$.when.apply($,b)},b.prototype._trim=function(a,b,c){var d=this,e=c.fields;return _.map(b,function(a){return _.mapValues(a,function(a,b){return _.includes(e,b)?d.utils.trim(a):a})})},b.prototype._cast=function(a,b,c){var d=this,e=_.pluck(c.fields,"field");return _.map(b,function(a){return _.mapValues(a,function(a,b){if(_.contains(e,b)){var f=_.findWhere(c.fields,{field:b}),g=f.type,h=f.args;return d.utils.cast.apply(null,[a,g].concat(h))}return a})})},b.prototype._substr=function(a,b,c){var d=c.field,e=c.start,f=c.end;return _.map(b,function(a){return a[d]=String(a[d]).substring(e,f),a})},b.prototype.tables=function(){var a=this;if(a instanceof b)return a._resources={},a._tables=_.toArray(arguments),a;var c=new b;return c.tables.apply(c,_.toArray(arguments))},b.prototype.ops=function(a){var b=this;return b._operations=a,b},b.prototype.execute=function(a){var b=this,c=_.pluck(b._tables,"as");b._fetchResources().done(function(){var d=_.map(_.toArray(arguments),b._normalizeTable,b);b._resources=_.zipObject(c,d),b._runOps(),a(b._result)})},a.DataQL=b,a.tables=b.prototype.tables}(window),function(){"use strict";DataQL.prototype._sum=function(a,b,c){return _.values(_.reduce(b,function(a,b){var d=b[c.groupBy],e=c.field,f=c.as||e,g=Number(b[e]);return d in a?a[d][f]=Number(a[d][f])+g:(a[d]=b,a[d][f]=g),a},{}))},DataQL.prototype._avg=function(a,b,c){var d,e=c.field,f=c.as||"avg",g=_.values(_.reduce(b,function(a,b){var f=b[c.groupBy],g=Number(b[e]);return f in a?(d=Number(a[f][e]),a[f].__total=Number(a[f].__total)+g,a[f].__count=d+1):(a[f]=b,a[f].__total=g,a[f].__count=1),a},{}));return _.map(g,function(a){return a[f]=a.__total/a.__count,_.omit(a,"__total","__count")})},DataQL.prototype._percentage=function(a,b,c){var d=c.field,e=c.as||"percentage",f=0,g=_.values(_.reduce(b,function(a,b){var e=b[c.groupBy],g=Number(b[d]);return e in a?a[e].__total=Number(a[e].__total)+g:(a[e]=b,a[e].__total=g),f+=g,a},{}));return _.map(g,function(a){return a[e]=a.__total/f,_.omit(a,"__total")})},DataQL.prototype._max=function(a,b,c){return _.values(_.reduce(b,function(a,b){var d,e=b[c.groupBy],f=c.field,g=c.as||f,h=Number(b[f]);return e in a?(d=Number(a[e][g]),h>d&&(a[e][g]=h)):(a[e]=b,a[e][g]=h),a},{}))},DataQL.prototype._min=function(a,b,c){return _.values(_.reduce(b,function(a,b){var d,e=b[c.groupBy],f=c.field,g=c.as||f,h=Number(b[f]);return e in a?(d=Number(a[e][g]),d>h&&(a[e][g]=h)):(a[e]=b,a[e][g]=h),a},{}))},DataQL.prototype._count=function(a,b,c){return _.values(_.reduce(b,function(a,b){var d,e=b[c.groupBy],f=c.as||"count";return e in a?(d=Number(a[e][f]),a[e][f]=d+1):(a[e]=b,a[e][f]=1),a},{}))}}(window),function(){"use strict";DataQL.prototype.parse=function(){}}(window),function(){"use strict";var a={string:String,"boolean":Boolean,number:Number,date:Date,integer:parseInt,"float":parseFloat};DataQL.prototype.utils={},DataQL.prototype.utils.trim=function(a){return a.replace(/^\s+|\s+$/gm,"")},DataQL.prototype.utils.cast=function(b,c){var d=_.drop(_.toArray(arguments),2);return a[c].apply(null,[b].concat(d))}}(window);